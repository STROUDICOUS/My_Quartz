---
myCodeProperty: "const offenceType = dv.current().file.frontmatter.OffenceType.map(item => item.replace(/\\[\\[|\\]\\]/g, '').trim());const Issue = \"ALL\";const Callout = [\"quote\", \"warning\", \"tip\", \"error\", \"question\"];const typeValue = \"Email\";const quoteCollapse = dv.current().file.frontmatter[\"QuoteCollapse\"];const collapseState = quoteCollapse === true ? '-' : '+';const quoteRegEx = /\\[\\[([^\\]]*?\\^.*?)\\]\\]/g;const wikilinkAsCalloutHashtagRegEx = new RegExp(`\\\\[\\\\[(${Callout.join(\"|\")})\\\\|\\\\]\\\\]`, \"g\");function formatDateTime(dateTime) {    if (!dateTime) return \"Date not provided\";    const date = new Date(dateTime);    if (isNaN(date)) return \"Invalid date\";    const options = { weekday: 'short', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', hour12: true };    return new Intl.DateTimeFormat('en-GB', options).format(date);}let uniqueIssueTypes = [];if (Issue === \"ALL\") {    dv.pages().where(p => p.file.frontmatter.Type === \"Issue\").forEach(p => uniqueIssueTypes.push(p.file.name));} else {    uniqueIssueTypes = Issue;}let uniqueOffenceTypes = [];if (offenceType === \"ALL\") {    dv.pages().where(p => p.file.frontmatter.Type === \"Offence\").forEach(p => uniqueOffenceTypes.push(p.file.name));} else {    uniqueOffenceTypes = offenceType;}const offencePattern = new RegExp(uniqueOffenceTypes.map(o => `\\\\[\\\\[${o}\\\\|\\\\]\\\\]`).join(\"|\"), \"g\");const issuePattern = new RegExp(uniqueIssueTypes.map(i => `\\\\[\\\\[${i}\\\\|\\\\]\\\\]`).join(\"|\"), \"g\");const pages = dv.pages().where(p => p.Type === typeValue);const sortedPages = [...pages].sort((a, b) => {    const dateA = new Date(a.file.frontmatter.DateTime);    const dateB = new Date(b.file.frontmatter.DateTime);    return dateA - dateB;});sortedPages.forEach(page => {    const formattedDateTime = formatDateTime(page.file.frontmatter.DateTime);    const theLink = page.file.path;    const dateTimefileLink = `[[${theLink}|${formattedDateTime}]]`;    const subjectFileLink = `[[${theLink}|${page.Subject}]]`;    const tasks = page.file.tasks.where(t => !t.completed && t.text.match(wikilinkAsCalloutHashtagRegEx) && t.text.match(issuePattern) && t.text.match(offencePattern));    if (tasks.length > 0) {        const fileNameOnly = page.file.name;        const description = page.description ? `${fileNameOnly}|${page.description}` : fileNameOnly;        const markdownLink = `[[${description}]]`;        const sentBy = page.SentBy;        dv.paragraph(`Sent by ${sentBy} On: ${dateTimefileLink}  \\n*Subject:* ${subjectFileLink}  \\n${page.description}`);        tasks.forEach(task => {            const short_description = page.short_description ? `${fileNameOnly}|${page.short_description}` : fileNameOnly;            let foundCallout = Callout.find(callout => task.text.includes(`[[${callout}|]]`)) || \"note\";            let modifiedText = task.text.replace(quoteRegEx, \"\");            let modifiedQuote = task.text.match(quoteRegEx);            dv.paragraph(`> [!${foundCallout}] [[NOTHING|]]\\n${modifiedText}  \"!${modifiedQuote}`);        });        dv.paragraph(`--- `);    }});"
icon: FiCode
OffenceType: []
---
## ChatGPT Prompt
Strip out redundant comments, line breaks and tabs and please leave the .where() in this code. just remove the comments and DO NOT ALTER any other part.

<p><span><p>Sent by <a data-tooltip-position="top" aria-label="50 Queens Avenue/supporting information/Spyridon Leoussis.md" data-href="50 Queens Avenue/supporting information/Spyridon Leoussis.md" href="50 Queens Avenue/supporting information/Spyridon Leoussis.md" class="internal-link" target="_blank" rel="noopener">Spyridon Leoussis</a> On: <a data-tooltip-position="top" aria-label="50 Queens Avenue/emails/Sandbox Email.md" data-href="50 Queens Avenue/emails/Sandbox Email.md" href="50 Queens Avenue/emails/Sandbox Email.md" class="internal-link" target="_blank" rel="noopener">Fri, 20 January 2017 at 05:09 pm</a><br>
<em>Subject:</em> <a data-tooltip-position="top" aria-label="50 Queens Avenue/emails/Sandbox Email.md" data-href="50 Queens Avenue/emails/Sandbox Email.md" href="50 Queens Avenue/emails/Sandbox Email.md" class="internal-link" target="_blank" rel="noopener">RE: FW: 50 Queens Avenue</a><br>
re: CCTV</p></span></p><p><span><div data-callout-metadata="" data-callout-fold="" data-callout="error" class="callout node-insert-event drop-shadow"><div class="callout-title"><div class="callout-icon"><svg width="16" height="16"></svg></div><div class="callout-title-inner"><a data-tooltip-position="top" aria-label="NOTHING" data-href="NOTHING" href="NOTHING" class="internal-link" target="_blank" rel="noopener"></a></div></div><div class="callout-content">
<p><a data-tooltip-position="top" aria-label="error" data-href="error" href="error" class="internal-link" target="_blank" rel="noopener"></a> <a data-tooltip-position="top" aria-label="Side Gate Issue" data-href="Side Gate Issue" href="Side Gate Issue" class="internal-link" target="_blank" rel="noopener"></a> <a data-tooltip-position="top" aria-label="Coercive Financial Ultimatum" data-href="Coercive Financial Ultimatum" href="Coercive Financial Ultimatum" class="internal-link" target="_blank" rel="noopener"></a> This callout is being pulled in from a test email. And the below quote SIDE GATE ISSUE??? This should have an embedded note  <span alt="" src="Sandbox Email#^fa7aac" class="internal-embed"></span></p>
</div></div></span></p><p><span><hr></span></p><p><span><p>Sent by <a data-tooltip-position="top" aria-label="50 Queens Avenue/supporting information/Martin Hughes.md" data-href="50 Queens Avenue/supporting information/Martin Hughes.md" href="50 Queens Avenue/supporting information/Martin Hughes.md" class="internal-link" target="_blank" rel="noopener">Martin Hughes</a> On: <a data-tooltip-position="top" aria-label="50 Queens Avenue/emails/2020-08-03 19.20 ~ martinhughespiano@gmail.com to Hazem (Re. Maintenance for front of the house).md" data-href="50 Queens Avenue/emails/2020-08-03 19.20 ~ martinhughespiano@gmail.com to Hazem (Re. Maintenance for front of the house).md" href="50 Queens Avenue/emails/2020-08-03 19.20 ~ martinhughespiano@gmail.com to Hazem (Re. Maintenance for front of the house).md" class="internal-link" target="_blank" rel="noopener">Mon, 3 August 2020 at 07:20 pm</a><br>
<em>Subject:</em> <a data-tooltip-position="top" aria-label="50 Queens Avenue/emails/2020-08-03 19.20 ~ martinhughespiano@gmail.com to Hazem (Re. Maintenance for front of the house).md" data-href="50 Queens Avenue/emails/2020-08-03 19.20 ~ martinhughespiano@gmail.com to Hazem (Re. Maintenance for front of the house).md" href="50 Queens Avenue/emails/2020-08-03 19.20 ~ martinhughespiano@gmail.com to Hazem (Re. Maintenance for front of the house).md" class="internal-link" target="_blank" rel="noopener">Re: Maintenance for front of the house</a><br>
<a data-href="Martin Hughes" href="Martin Hughes" class="internal-link" target="_blank" rel="noopener">Martin Hughes</a> responds to <a data-tooltip-position="top" aria-label="Hazem El Akhnawy" data-href="Hazem El Akhnawy" href="Hazem El Akhnawy" class="internal-link" target="_blank" rel="noopener">Hazem</a> and everybody, saying that he was not aware of the repairs. <a data-tooltip-position="top" aria-label="Hattie Hughes" data-href="Hattie Hughes" href="Hattie Hughes" class="internal-link" target="_blank" rel="noopener">Hattie</a> had not moved in at this point</p></span></p><p><span><div data-callout-metadata="" data-callout-fold="" data-callout="warning" class="callout node-insert-event drop-shadow"><div class="callout-title"><div class="callout-icon"><svg width="16" height="16"></svg></div><div class="callout-title-inner"><a data-tooltip-position="top" aria-label="NOTHING" data-href="NOTHING" href="NOTHING" class="internal-link" target="_blank" rel="noopener"></a></div></div><div class="callout-content">
<p><a data-tooltip-position="top" aria-label="warning" data-href="warning" href="warning" class="internal-link" target="_blank" rel="noopener"></a> <a data-tooltip-position="top" aria-label="Side Gate Issue" data-href="Side Gate Issue" href="Side Gate Issue" class="internal-link" target="_blank" rel="noopener"></a> <a data-tooltip-position="top" aria-label="Coercive Financial Ultimatum" data-href="Coercive Financial Ultimatum" href="Coercive Financial Ultimatum" class="internal-link" target="_blank" rel="noopener"></a> Something  </p>
</div></div></span></p><p><span><div data-callout-metadata="" data-callout-fold="" data-callout="tip" class="callout node-insert-event drop-shadow"><div class="callout-title"><div class="callout-icon"><svg width="16" height="16"></svg></div><div class="callout-title-inner"><a data-tooltip-position="top" aria-label="NOTHING" data-href="NOTHING" href="NOTHING" class="internal-link" target="_blank" rel="noopener"></a></div></div><div class="callout-content">
<p><a data-tooltip-position="top" aria-label="tip" data-href="tip" href="tip" class="internal-link" target="_blank" rel="noopener"></a> <a data-tooltip-position="top" aria-label="Pushchair Issue" data-href="Pushchair Issue" href="Pushchair Issue" class="internal-link" target="_blank" rel="noopener"></a> <a data-tooltip-position="top" aria-label="Coercive Financial Ultimatum" data-href="Coercive Financial Ultimatum" href="Coercive Financial Ultimatum" class="internal-link" target="_blank" rel="noopener"></a> Something about pushchairs  </p>
</div></div></span></p><p><span><div data-callout-metadata="" data-callout-fold="" data-callout="tip" class="callout node-insert-event drop-shadow"><div class="callout-title"><div class="callout-icon"><svg width="16" height="16"></svg></div><div class="callout-title-inner"><a data-tooltip-position="top" aria-label="NOTHING" data-href="NOTHING" href="NOTHING" class="internal-link" target="_blank" rel="noopener"></a></div></div><div class="callout-content">
<p><a data-tooltip-position="top" aria-label="tip" data-href="tip" href="tip" class="internal-link" target="_blank" rel="noopener"></a> <a data-tooltip-position="top" aria-label="Pushchair Issue" data-href="Pushchair Issue" href="Pushchair Issue" class="internal-link" target="_blank" rel="noopener"></a> <a data-tooltip-position="top" aria-label="Autocratic Unilateral Action" data-href="Autocratic Unilateral Action" href="Autocratic Unilateral Action" class="internal-link" target="_blank" rel="noopener"></a>Pushchair, autocratic and tip   <span alt="" src="2020-08-03 19.20 ~ martinhughespiano@gmail.com to Hazem (Re. Maintenance for front of the house)#^420f0d" class="internal-embed"></span></p>
</div></div></span></p><p><span><hr></span></p>